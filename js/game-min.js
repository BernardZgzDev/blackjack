const blackjackGame=(()=>{"use strict";const e=document.querySelectorAll(".puntaje"),t=document.querySelectorAll(".div-cartas-jugadores"),s=document.querySelector("#btnNuevo"),l=document.querySelector("#btnPedir"),o=document.querySelector("#btnPlantarse"),r={"players-points":e,"players-deck":t},n=["H","D","C","S"],i=["A","J","Q","K"];let c=[],a=[],d=!1;s.addEventListener("click",()=>{u()}),l.addEventListener("click",()=>{k("players-deck",0)}),o.addEventListener("click",()=>{N()});const u=(e=2)=>{p(e);for(let e=2;e<=10;e++)for(let t of n)c.push(e+t);for(let e of i)for(let t of n)c.push(e+t);c=_.shuffle(c),w(l,!1),w(o,!1),w(s,!0)},p=e=>{a=[];for(let t=0;t<e;t++)a.push(0);c=[];let t=h("players-points",0);f(t,a[0]),t=h("players-points",a.length-1),f(t,a[1]),t=h("players-deck",0),y(t),t=h("players-deck",a.length-1),y(t)},h=(e,t)=>r[e][t],f=(e,t)=>{e.innerText=t,0===a[0]?w(o,!0):a[0]>=1&&a[0]<21?w(o,!1):21===a[0]?(w(o,!0),w(l,!0),d||(d=!0,N())):(w(l,!0),w(o,!0),w(s,!1),d||(d=!0,N()))},y=e=>{for(;e.hasChildNodes();)e.removeChild(e.firstChild)},k=(e,t)=>{if(0===c.length)throw"No cards in deck";const s=c.shift(),l=1*m(s),o=h(e,t);g(s,o),b(l,t)},m=e=>{const t=e.substring(0,e.length-1);return["A"].includes(t)?11:["J","Q","K"].includes(t)?10:t},g=(e,t)=>{const s=document.createElement("img");s.src=`assets/cards/${e}.png`,s.height="240",s.classList.add("carta"),t.append(s)},b=(e,t)=>{if(0===t){let s=h("players-points",t);isNaN(a[0])?a[0]=e:a[0]+=e,f(s,a[0])}else{let s=h("players-points",t);isNaN(a[1])?a[1]=e:a[1]+=e,f(s,a[1])}},w=(e,t)=>{e.disabled=t},N=()=>{w(l,!0),w(o,!0);let e=v();d=!1,setTimeout(()=>{S(e)},100),w(s,!1),w(l,!0),w(o,!0)},v=()=>{let e="";do{if(k("players-deck",a.length-1),21===a[0]&&21===a[1]){e="tie";break}if(a[0]>21||a[1]>a[0]&&a[1]<=21){e="lost";break}if(a[1]>21){e="won";break}}while(a[1]<=a[0]||21===a[1]);return e},S=e=>{"won"===e?swal({title:"Awesome !!!",text:"You won!",icon:"success"}):"lost"===e?swal({title:"Bad news !",text:"You lost!",icon:"error"}):swal({title:"Oh my god !!!",text:"You both got 21. It's a tie",icon:"info"})};return{initGame:()=>{b(0,0),b(0,1),w(l,!0),w(o,!0)}}})();